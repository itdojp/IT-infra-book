<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="700" viewBox="0 0 800 700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      /* Color Palette */
      :root {
        --bg-primary: #FFFFFF;
        --bg-secondary: #F8F9FA;
        --text-primary: #1A1A1A;
        --text-secondary: #6B7280;
        --primary: #3B82F6;
        --success: #10B981;
        --warning: #F59E0B;
        --error: #EF4444;
        --neutral: #6B7280;
        --border: #E5E7EB;
        --master-bg: #10B981;
        --slave-bg: #3B82F6;
        --sync-bg: #e3f2fd;
        --async-bg: #fff3e0;
        --semi-bg: #f3e5f5;
      }
      
      /* Dark Theme */
      @media (prefers-color-scheme: dark) {
        :root {
          --bg-primary: #1A1A1A;
          --bg-secondary: #2D2D2D;
          --text-primary: #FFFFFF;
          --text-secondary: #9CA3AF;
          --primary: #60A5FA;
          --success: #34D399;
          --warning: #FBBF24;
          --error: #F87171;
          --neutral: #9CA3AF;
          --border: #374151;
          --master-bg: #34D399;
          --slave-bg: #60A5FA;
          --sync-bg: #1A237E;
          --async-bg: #E65100;
          --semi-bg: #4A148C;
        }
      }
      
      /* Typography */
      .title-text {
        font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
        font-size: 16px;
        font-weight: 600;
        text-anchor: middle;
        fill: var(--text-primary);
      }
      
      .label-text {
        font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
        font-size: 12px;
        font-weight: 500;
        text-anchor: middle;
        fill: var(--text-primary);
      }
      
      .annotation-text {
        font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
        font-size: 10px;
        font-weight: 400;
        text-anchor: middle;
        fill: var(--text-secondary);
      }
      
      .section-title {
        font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif;
        font-size: 14px;
        font-weight: 600;
        text-anchor: middle;
        fill: var(--text-primary);
      }
      
      /* Node Styles */
      .master-node {
        fill: var(--master-bg);
        stroke: var(--master-bg);
        stroke-width: 2;
      }
      
      .slave-node {
        fill: var(--slave-bg);
        stroke: var(--slave-bg);
        stroke-width: 2;
      }
      
      /* Connection Lines */
      .sync-write-line {
        stroke: var(--success);
        stroke-width: 2;
        marker-end: url(#arrow-green);
      }
      
      .sync-ack-line {
        stroke: var(--primary);
        stroke-width: 2;
        marker-end: url(#arrow-blue);
      }
      
      .async-propagation {
        stroke: var(--warning);
        stroke-width: 2;
        stroke-dasharray: 4,4;
        opacity: 0.7;
        marker-end: url(#arrow-orange);
      }
      
      .semi-sync-write {
        stroke: var(--success);
        stroke-width: 2;
        marker-end: url(#arrow-green);
      }
      
      .semi-async-write {
        stroke: var(--warning);
        stroke-width: 2;
        stroke-dasharray: 4,4;
        marker-end: url(#arrow-orange);
      }
    </style>
    
    <!-- Arrow Markers -->
    <marker id="arrow-green" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="var(--success)"/>
    </marker>
    <marker id="arrow-blue" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="var(--primary)"/>
    </marker>
    <marker id="arrow-orange" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="var(--warning)"/>
    </marker>
  </defs>
  
  <title>レプリケーション方式</title>
  <desc>同期、非同期、準同期レプリケーションの動作比較</desc>
  
  <!-- Background -->
  <rect width="100%" height="100%" fill="var(--bg-primary)"/>
  
  <!-- Main Title -->
  <text x="400" y="24" class="title-text">レプリケーション方式</text>
  
  <!-- Synchronous Replication -->
  <rect x="50" y="60" width="200" height="20" rx="3" fill="var(--sync-bg)" stroke="var(--success)" stroke-width="1"/>
  <text x="150" y="74" class="section-title">同期レプリケーション</text>
  
  <!-- Sync Master -->
  <rect x="120" y="100" width="60" height="40" rx="4" class="master-node"/>
  <text x="150" y="124" class="label-text" fill="white">マスター</text>
  
  <!-- Sync Slaves -->
  <rect x="70" y="160" width="60" height="40" rx="4" class="slave-node"/>
  <text x="100" y="184" class="label-text" fill="white">スレーブ1</text>
  
  <rect x="170" y="160" width="60" height="40" rx="4" class="slave-node"/>
  <text x="200" y="184" class="label-text" fill="white">スレーブ2</text>
  
  <!-- Sync Connections -->
  <line x1="140" y1="140" x2="100" y2="160" class="sync-write-line"/>
  <line x1="160" y1="140" x2="200" y2="160" class="sync-write-line"/>
  <text x="120" y="155" class="annotation-text">1. 書込</text>
  <text x="180" y="155" class="annotation-text">1. 書込</text>
  
  <line x1="100" y1="160" x2="140" y2="140" class="sync-ack-line"/>
  <line x1="200" y1="160" x2="160" y2="140" class="sync-ack-line"/>
  <text x="110" y="145" class="annotation-text">2. ACK</text>
  <text x="190" y="145" class="annotation-text">2. ACK</text>
  
  <!-- Sync Commit -->
  <text x="150" y="220" class="annotation-text">3. コミット</text>
  
  <!-- Asynchronous Replication -->
  <rect x="300" y="60" width="200" height="20" rx="3" fill="var(--async-bg)" stroke="var(--warning)" stroke-width="1"/>
  <text x="400" y="74" class="section-title">非同期レプリケーション</text>
  
  <!-- Async Master -->
  <rect x="370" y="100" width="60" height="40" rx="4" class="master-node"/>
  <text x="400" y="124" class="label-text" fill="white">マスター</text>
  
  <!-- Async Slaves -->
  <rect x="320" y="160" width="60" height="40" rx="4" class="slave-node"/>
  <text x="350" y="184" class="label-text" fill="white">スレーブ1</text>
  
  <rect x="420" y="160" width="60" height="40" rx="4" class="slave-node"/>
  <text x="450" y="184" class="label-text" fill="white">スレーブ2</text>
  
  <!-- Async Connections -->
  <text x="400" y="155" class="annotation-text">1. コミット</text>
  
  <line x1="390" y1="140" x2="350" y2="160" class="async-propagation"/>
  <line x1="410" y1="140" x2="450" y2="160" class="async-propagation"/>
  <text x="370" y="155" class="annotation-text">2. 伝播</text>
  <text x="430" y="155" class="annotation-text">2. 伝播</text>
  
  <!-- Semi-synchronous Replication -->
  <rect x="550" y="60" width="200" height="20" rx="3" fill="var(--semi-bg)" stroke="var(--error)" stroke-width="1"/>
  <text x="650" y="74" class="section-title">準同期レプリケーション</text>
  
  <!-- Semi Master -->
  <rect x="620" y="100" width="60" height="40" rx="4" class="master-node"/>
  <text x="650" y="124" class="label-text" fill="white">マスター</text>
  
  <!-- Semi Slaves -->
  <rect x="570" y="160" width="60" height="40" rx="4" class="slave-node"/>
  <text x="600" y="184" class="label-text" fill="white">スレーブ1</text>
  
  <rect x="670" y="160" width="60" height="40" rx="4" class="slave-node"/>
  <text x="700" y="184" class="label-text" fill="white">スレーブ2</text>
  
  <!-- Semi Connections -->
  <line x1="640" y1="140" x2="600" y2="160" class="semi-sync-write"/>
  <line x1="660" y1="140" x2="700" y2="160" class="semi-async-write"/>
  <text x="620" y="155" class="annotation-text">1. 書込</text>
  <text x="680" y="155" class="annotation-text">1. 書込</text>
  
  <line x1="600" y1="160" x2="640" y2="140" class="sync-ack-line"/>
  <text x="615" y="145" class="annotation-text">2. ACK</text>
  
  <text x="650" y="220" class="annotation-text">3. コミット<br/>（1台のACKで）</text>
  
  <!-- Comparison Table -->
  <rect x="50" y="260" width="700" height="420" rx="6" fill="var(--bg-secondary)" stroke="var(--border)" stroke-width="1"/>
  <text x="400" y="280" class="title-text">レプリケーション方式比較</text>
  
  <!-- Sync Details -->
  <rect x="70" y="300" width="200" height="160" rx="4" fill="var(--sync-bg)" fill-opacity="0.1" stroke="var(--success)" stroke-width="1"/>
  <text x="170" y="320" class="section-title">同期レプリケーション</text>
  
  <text x="80" y="340" class="label-text" text-anchor="start">特徴:</text>
  <text x="85" y="356" class="annotation-text" text-anchor="start">• 全レプリカ反映後にコミット</text>
  <text x="85" y="368" class="annotation-text" text-anchor="start">• データロス: ゼロ</text>
  <text x="85" y="380" class="annotation-text" text-anchor="start">• 書込レイテンシ: 高</text>
  
  <text x="80" y="400" class="label-text" text-anchor="start">適用場面:</text>
  <text x="85" y="416" class="annotation-text" text-anchor="start">• 金融取引システム</text>
  <text x="85" y="428" class="annotation-text" text-anchor="start">• 重要なマスターデータ</text>
  <text x="85" y="440" class="annotation-text" text-anchor="start">• コンプライアンス要件</text>
  
  <!-- Async Details -->
  <rect x="300" y="300" width="200" height="160" rx="4" fill="var(--async-bg)" fill-opacity="0.1" stroke="var(--warning)" stroke-width="1"/>
  <text x="400" y="320" class="section-title">非同期レプリケーション</text>
  
  <text x="310" y="340" class="label-text" text-anchor="start">特徴:</text>
  <text x="315" y="356" class="annotation-text" text-anchor="start">• 即座にコミット、後で伝播</text>
  <text x="315" y="368" class="annotation-text" text-anchor="start">• データロス: 可能性あり</text>
  <text x="315" y="380" class="annotation-text" text-anchor="start">• 書込レイテンシ: 低</text>
  
  <text x="310" y="400" class="label-text" text-anchor="start">適用場面:</text>
  <text x="315" y="416" class="annotation-text" text-anchor="start">• ログ集約システム</text>
  <text x="315" y="428" class="annotation-text" text-anchor="start">• 分析用データ</text>
  <text x="315" y="440" class="annotation-text" text-anchor="start">• 高スループット要求</text>
  
  <!-- Semi Details -->
  <rect x="530" y="300" width="200" height="160" rx="4" fill="var(--semi-bg)" fill-opacity="0.1" stroke="var(--error)" stroke-width="1"/>
  <text x="630" y="320" class="section-title">準同期レプリケーション</text>
  
  <text x="540" y="340" class="label-text" text-anchor="start">特徴:</text>
  <text x="545" y="356" class="annotation-text" text-anchor="start">• 一部レプリカ反映でコミット</text>
  <text x="545" y="368" class="annotation-text" text-anchor="start">• データロス: 最小限</text>
  <text x="545" y="380" class="annotation-text" text-anchor="start">• 書込レイテンシ: 中</text>
  
  <text x="540" y="400" class="label-text" text-anchor="start">適用場面:</text>
  <text x="545" y="416" class="annotation-text" text-anchor="start">• 一般的なWebアプリ</text>
  <text x="545" y="428" class="annotation-text" text-anchor="start">• バランス重視システム</text>
  <text x="545" y="440" class="annotation-text" text-anchor="start">• 地理分散環境</text>
  
  <!-- Performance Metrics -->
  <rect x="70" y="480" width="660" height="180" rx="4" fill="var(--primary)" fill-opacity="0.1" stroke="var(--primary)" stroke-width="1"/>
  <text x="400" y="500" class="section-title">パフォーマンス特性</text>
  
  <!-- Latency Table -->
  <text x="80" y="525" class="label-text" text-anchor="start">書込レイテンシ (ms):</text>
  <text x="90" y="545" class="annotation-text" text-anchor="start">ローカル: 1ms</text>
  <text x="90" y="560" class="annotation-text" text-anchor="start">同一DC同期: 2〜5ms</text>
  <text x="90" y="575" class="annotation-text" text-anchor="start">異DC同期: 10〜100ms</text>
  <text x="90" y="590" class="annotation-text" text-anchor="start">非同期: 1〜2ms</text>
  <text x="90" y="605" class="annotation-text" text-anchor="start">準同期: 2〜10ms</text>
  
  <!-- Data Loss Risk -->
  <text x="300" y="525" class="label-text" text-anchor="start">データロスリスク:</text>
  <text x="310" y="545" class="annotation-text" text-anchor="start">同期: なし</text>
  <text x="310" y="560" class="annotation-text" text-anchor="start">非同期: 数秒〜数分</text>
  <text x="310" y="575" class="annotation-text" text-anchor="start">準同期: 数百ms〜数秒</text>
  
  <!-- Implementation Complexity -->
  <text x="500" y="525" class="label-text" text-anchor="start">実装複雑度:</text>
  <text x="510" y="545" class="annotation-text" text-anchor="start">同期: 中（タイムアウト処理）</text>
  <text x="510" y="560" class="annotation-text" text-anchor="start">非同期: 低（シンプル）</text>
  <text x="510" y="575" class="annotation-text" text-anchor="start">準同期: 高（フェイルオーバー考慮）</text>
  
  <!-- Use Case Selection -->
  <text x="80" y="630" class="label-text" text-anchor="start">選択指針:</text>
  <text x="90" y="650" class="annotation-text" text-anchor="start">• データロス許容度が最重要判断基準</text>
  <text x="90" y="665" class="annotation-text" text-anchor="start">• パフォーマンス要件との兼ね合い</text>
  
</svg>